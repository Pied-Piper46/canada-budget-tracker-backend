<script src="https://cdn.plaid.com/link/v2/stable/link-initialize.js"></script>
<script>
    async function initializePlaid() {
        const response = await fetch("http://127.0.0.1:8000/create_link_token", {
            method: "POST",
            headers: { "Content-Type": "application/json" }
        });
        const { link_token } = await response.json()

        const linkHandler = Plaid.create({
            token: link_token,
            onSuccess: (public_token, metadata) => {
                fetch("http://127.0.0.1:8000/exchange_public_token", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify( {public_token })
                })
                    .then(response => response.json())
                    .then(data => console.log("Access Token: ", data.access_token))
                    .catch(error => console.error("Error: ", error));
            },
            onExit: (err, metadata) => {
                console.error("Link exited: ", err, metadata);
            }
        });

        linkHandler.open();
    }
</script>
<button onClick="initializePlaid()">Connect Bank</button>